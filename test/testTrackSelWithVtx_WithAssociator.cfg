# Test on a sample with real pileup from CMSSW_1_3_1 production

process Test2 = {
    include "FWCore/MessageService/data/MessageLogger.cfi"

    source = PoolSource {
        untracked vstring fileNames = { 
                '/store/mc/2007/4/27/Spring07-ttbar_inclusive_TopRex-1122/0002/1C59DE49-21FA-DB11-9DBD-0018FE28DF8E.root' 
        }
        untracked int32 maxEvents = 25
    }

    include "PhysicsTools/RecoSelectors/data/TrackWithVertexSelector.cfi"

    module jetGoodTrackAssociator = jetTracksAssociator 
        from "RecoBTau/JetTracksAssociator/data/jetTracksAssociator.cfi"
    replace jetGoodTrackAssociator.tracks = trackWithVertexSelector


    module out = PoolOutputModule {
        untracked string fileName = 'select-vtx-ass.root' 
        untracked vstring outputCommands = {
                'drop *',
                'keep recoTracks_*_*_*',
                'keep *_offlinePrimaryVerticesFromCTFTracks_*_*',
                'keep *_jetGoodTrackAssociator_*_*'
        }
    }

    module ascii = AsciiOutputModule { }

    path    p = { trackWithVertexSelector, jetGoodTrackAssociator }

    replace trackWithVertexSelector.useVtx    = true
    replace trackWithVertexSelector.nVertices = 1

    endpath e = { ascii, out }
}
